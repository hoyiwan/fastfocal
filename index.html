<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fast Multiscale Raster Extraction and Moving Window Analysis with FFT • fastfocal</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Fast Multiscale Raster Extraction and Moving Window Analysis with FFT">
<meta name="description" content='Provides fast moving-window ("focal") and buffer-based extraction for raster data using the terra package. Automatically selects between a C++ backend (via terra) and a Fast Fourier Transform (FFT) backend depending on problem size. The FFT backend supports sum and mean, while other statistics (e.g., median, min, max, standard deviation) are handled by the terra backend. Supports multiple kernel types (e.g., circle, rectangle, gaussian), with NA handling consistent with terra via na.rm and na.policy. Operates on SpatRaster objects and returns results with the same geometry.'>
<meta property="og:description" content='Provides fast moving-window ("focal") and buffer-based extraction for raster data using the terra package. Automatically selects between a C++ backend (via terra) and a Fast Fourier Transform (FFT) backend depending on problem size. The FFT backend supports sum and mean, while other statistics (e.g., median, min, max, standard deviation) are handled by the terra backend. Supports multiple kernel types (e.g., circle, rectangle, gaussian), with NA handling consistent with terra via na.rm and na.policy. Operates on SpatRaster objects and returns results with the same geometry.'>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fastfocal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/benchmark.html">Benchmarking fastfocal</a></li>
    <li><a class="dropdown-item" href="articles/index.html">fastfocal: Fast Multi-scale Raster Extraction and Moving Window Analysis with FFT</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hoyiwan/fastfocal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="fastfocal">fastfocal<a class="anchor" aria-label="anchor" href="#fastfocal"></a>
</h1></div>
<p><a href="https://CRAN.R-project.org/package=fastfocal" class="external-link"><img src="https://www.r-pkg.org/badges/version/fastfocal" alt="CRAN Status"></a> <a href="https://github.com/hoyiwan/fastfocal/actions" class="external-link"><img src="https://github.com/hoyiwan/fastfocal/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://doi.org/10.5281/zenodo.17074691" class="external-link"><img src="https://zenodo.org/badge/961060307.svg" alt="DOI"></a></p>
<p><strong>fastfocal: Fast Multi-scale Raster Extraction and Moving Window Analysis with Fast Fourier Transform (FFT) in R</strong></p>
<p><code>fastfocal</code> provides high-performance, flexible raster smoothing and extraction functions in R using moving windows, buffer-based zones, and an auto-switching FFT backend for large kernels. It supports multiple focal statistics and allows users to work at multiple spatial scales with ease.</p>
<hr>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Once accepted on CRAN, you will be able to install the stable release with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"fastfocal"</span><span class="op">)</span></span></code></pre></div>
<p>Until then, you can install the development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"hoyiwan/fastfocal"</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This package includes:</p>
<ul>
<li>
<code><a href="reference/fastfocal.html">fastfocal()</a></code> — fast moving-window smoothing with support for mean, sum, min, max, sd, and median<br>
</li>
<li>
<code><a href="reference/fastextract.html">fastextract()</a></code> — fast extraction of raster values at point or buffer locations<br>
</li>
<li>
<code><a href="reference/fastfocal_weights.html">fastfocal_weights()</a></code> — utility for generating spatial weight matrices (circular, Gaussian, etc.)<br>
</li>
<li>Auto-switch backend to FFT for large windows to improve performance
<ul>
<li>FFT backend currently supports <strong>sum</strong> and <strong>mean</strong>; other statistics use the <code>terra</code> backend<br>
</li>
</ul>
</li>
<li>Native support for <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">terra::SpatRaster</a></code> and <code><a href="https://rspatial.github.io/terra/reference/SpatVector-class.html" class="external-link">terra::SpatVector</a></code> objects</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hoyiwan.github.io/fastfocal/">fastfocal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a dummy raster</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="fl">100</span>, ncols <span class="op">=</span> <span class="fl">100</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">3000</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply fast focal smoothing with circular window of radius 300</span></span>
<span><span class="va">smoothed</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fastfocal.html">fastfocal</a></span><span class="op">(</span><span class="va">r</span>, d <span class="op">=</span> <span class="fl">300</span>, w <span class="op">=</span> <span class="st">"circle"</span>, fun <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the result</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">smoothed</span><span class="op">)</span></span></code></pre></div>
<p>Weighted extraction at points:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create SpatVector of points</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1500</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">2500</span><span class="op">)</span><span class="op">)</span>, geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract raster values in 500 m buffers around points</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fastextract.html">fastextract</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">pts</span>, d <span class="op">=</span> <span class="fl">500</span>, fun <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<ul>
<li>
<a href="https://hoyiwan.github.io/fastfocal/articles/index.html">Introduction (Index)</a><br>
</li>
<li><a href="https://hoyiwan.github.io/fastfocal/articles/benchmark.html">Benchmark: fastfocal vs terra::focal</a></li>
</ul>
<p>You can also access them from R using:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"index"</span>, package <span class="op">=</span> <span class="st">"fastfocal"</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This package is licensed under the <strong>MIT License</strong> (see the <a href="LICENSE">LICENSE</a> file).</p>
<hr>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <code>fastfocal</code> in published work, please cite it as:</p>
<blockquote>
<p>Ho Yi Wan (2025). <em>fastfocal: A fast, energy-efficient R package for focal raster operations</em>. Version v0.1.1. Zenodo. <a href="https://doi.org/10.5281/zenodo.17074691" class="external-link uri">https://doi.org/10.5281/zenodo.17074691</a></p>
</blockquote>
<p>Or use the BibTeX entry:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bibtex"><code class="sourceCode bibtex"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">@software{wan_fastfocal_2025,</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">  author       = {Ho Yi Wan},</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">  title        = {fastfocal: A fast, energy-efficient R package for focal raster operations},</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">  version      = {v0.1.3},</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">  year         = {2025},</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">  publisher    = {Zenodo},</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">  doi          = {10.5281/zenodo.17074691},</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">  url          = {https://doi.org/10.5281/zenodo.17074691}</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">}</span></span></code></pre></div>
<p>You can also run:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"fastfocal"</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a>
</h2>
<p><strong>Ho Yi Wan</strong><br><a href="mailto:hoyiwan@gmail.com" class="email">hoyiwan@gmail.com</a></p>
<hr>
</div>
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>Built to support large-scale ecological analysis, high-performance raster processing, and reproducible landscape research workflows.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=fastfocal" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/hoyiwan/fastfocal/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/hoyiwan/fastfocal/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fastfocal</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ho Yi Wan <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-2146-8257" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ho Yi Wan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
